diff -uNr a/api/nblib/samples/CMakeLists.txt b/api/nblib/samples/CMakeLists.txt
--- a/api/nblib/samples/CMakeLists.txt	2023-10-19 08:40:00.000000000 +0000
+++ b/api/nblib/samples/CMakeLists.txt	2023-12-18 09:41:22.050209780 +0000
@@ -39,12 +39,16 @@
 set(argon "argon-forces-integration")
 add_executable(${argon} argon-forces-integration.cpp)
 
-target_link_libraries(${argon} PRIVATE nblib)
+target_link_libraries(${argon} PRIVATE
+		      nblib
+		      ${GMX_EXE_LINKER_FLAGS})
 
 set(methane "methane-water-integration")
 add_executable(${methane} methane-water-integration.cpp)
 
-target_link_libraries(${methane} PRIVATE nblib)
+target_link_libraries(${methane} PRIVATE
+		      nblib
+		      ${GMX_EXE_LINKER_FLAGS})
 
 if(BUILD_TESTING)
     add_test(NAME NbLibSamplesTestArgon COMMAND ${argon})
diff -uNr a/cmake/FindcuFFTMp.cmake b/cmake/FindcuFFTMp.cmake
--- a/cmake/FindcuFFTMp.cmake	2023-10-19 08:40:00.000000000 +0000
+++ b/cmake/FindcuFFTMp.cmake	2023-12-15 17:12:53.849274758 +0000
@@ -34,8 +34,11 @@
 # - Find cuFFTMp, NVIDIA's FFT library for multi-GPU multi-node
 #
 # This script does define cache variables
-#   CUFFTMP_INCLUDE_DIR    - Location of cuFFTMP's include directory.
-#   CUFFTMP_LIBRARY        - Location of cuFFTMP's libraries
+#   cuFFTMp_INCLUDE_DIR     - Location of cuFFTMP's include directory.
+#   cuFFTMp_LIBRARY         - cuFFTMP library
+#   cuFFTMp_NVSHMEM_LIBRARY - nvshmem library to use with cuFFTMP
+#   cuFFTMp_NVSHMEM_HOST_LIBRARY nvshmem_host library to use with cuFFTMP
+#   cuFFTMp_NVIDIA_ML_LIBRARY nvidia_ml library to use with cuFFTMP
 #
 # If your cuFFTMp installation is not in a standard installation
 # directory, you may provide a hint to where it may be found. Simply
@@ -73,6 +76,44 @@
     ${PC_cuFFTMp_LIBRARY_DIRS}
     )
 
+# cufftmp depends on a particular NVSHEM
+#
+# TODO: If nvhpc is used cuFFTMp_NVSHMEM_ROOT_DIR could be derived from
+# cuFFTMp_ROOT_DIR and the CUDA version used.
+#
+find_path(cuFFTMp_NVSHMEM_ROOT_DIR
+    NAMES
+    include/nvshmem.h
+    HINTS
+    ${cuFFTMp_NVSHMEM_ROOT}
+    DOC "cuFFTMp-compatible NVSHMEM root directory.")
+
+find_library(cuFFTMp_NVSHMEM_LIBRARY
+    NAMES nvshmem
+    HINTS
+    ${cuFFTMp_NVSHMEM_ROOT_DIR}/lib64
+    ${cuFFTMp_NVSHMEM_ROOT_DIR}/lib
+)
+
+# nvshmem seems to depend on nvshmem_host
+find_library(cuFFTMp_NVSHMEM_HOST_LIBRARY
+    NAMES nvshmem_host
+    HINTS
+    ${cuFFTMp_NVSHMEM_ROOT_DIR}/lib64
+    ${cuFFTMp_NVSHMEM_ROOT_DIR}/lib
+)
+
+pkg_check_modules(PC_nvidia_ml QUIET nvidia-ml)
+
+# nvshmem_host seems to depend on nvidia-ml
+string(TOLOWER ${CMAKE_SYSTEM_NAME} cuFFTMp_SYSTEM_NAME_LOWER)
+find_library(cuFFTMp_NVIDIA_ML_LIBRARY
+    NAMES nvidia-ml
+    HINTS
+    PC_nvidia_ml_LIBRARY_DIRS
+    ${CUDA_TOOLKIT_ROOT_DIR}/targets/${CMAKE_SYSTEM_PROCESSOR}-${cuFFTMp_SYSTEM_NAME_LOWER}/lib/stubs
+)
+
 # handle the QUIETLY and REQUIRED arguments and set cuFFTMp_FOUND to TRUE if
 # all listed variables are TRUE
 include(FindPackageHandleStandardArgs)
diff -uNr a/src/gromacs/CMakeLists.txt b/src/gromacs/CMakeLists.txt
--- a/src/gromacs/CMakeLists.txt	2023-10-19 08:40:00.000000000 +0000
+++ b/src/gromacs/CMakeLists.txt	2023-12-15 23:47:00.182314220 +0000
@@ -185,6 +185,9 @@
     #we cannot link with both cufftmp and cufft
     if(GMX_USE_cuFFTMp)
         target_link_libraries(libgromacs PRIVATE ${cuFFTMp_LIBRARY})
+	target_link_libraries(libgromacs PRIVATE ${cuFFTMp_NVSHMEM_LIBRARY})
+	target_link_libraries(libgromacs PRIVATE ${cuFFTMp_NVSHMEM_HOST_LIBRARY})
+	target_link_libraries(libgromacs PRIVATE ${cuFFTMp_NVIDIA_ML_LIBRARY})
     else()
         target_link_libraries(libgromacs PRIVATE ${CUDA_CUFFT_LIBRARIES})
     endif()
